{"version":3,"file":"TableView.js","sources":["../../../../../src/components/DataView/TableView.js"],"sourcesContent":["import React, { useCallback, useMemo, useState } from 'react'\nimport PropTypes from 'prop-types'\nimport { Transition, animated } from 'react-spring'\nimport { GU, springs, textStyle } from '../../style'\nimport { useTheme } from '../../theme'\nimport { useLayout } from '../Layout/Layout'\nimport Checkbox from '../Input/Checkbox'\nimport { ToggleButton } from './ToggleButton'\nimport { OpenedSurfaceBorder } from './OpenedSurfaceBorder'\n\n// Table heading cells\nfunction headingsFromFields(\n  fields,\n  { hasAnyActions, hasAnyExpansion, selectContent, selectable }\n) {\n  const cells = fields.map((field, index) => [\n    field.label,\n    field.align === 'end' ? 'right' : 'left',\n  ])\n\n  if (hasAnyExpansion || selectable) {\n    cells.unshift([selectable ? selectContent : null, 'left'])\n  }\n\n  if (hasAnyActions) {\n    cells.push([null, 'left'])\n  }\n\n  // Return null if all the fields are empty\n  if (cells.every(cell => !cell[0])) {\n    return null\n  }\n\n  return cells\n}\n\nfunction cellsFromEntry(\n  entry,\n  {\n    fields,\n    hasAnyActions,\n    hasAnyExpansion,\n    hasExpansion,\n    selectContent,\n    selectable,\n    toggleChildContent,\n  }\n) {\n  const cells = entry.entryNodes.map((content, index) => [\n    content,\n    fields[index].align,\n    false,\n  ])\n\n  // Checkbox\n  if (selectable) {\n    cells.unshift([selectContent, 'start', true])\n  }\n\n  // Toggle child\n  if (!selectable && hasAnyExpansion) {\n    cells.unshift([hasExpansion && toggleChildContent, 'start', true])\n  }\n\n  // Actions\n  if (hasAnyActions) {\n    cells.push([entry.actions, 'end', true])\n  }\n\n  return cells\n}\n\nfunction TableView({\n  alignChildOnField,\n  allSelected,\n  entries,\n  fields,\n  hasAnyActions,\n  hasAnyExpansion,\n  onSelect,\n  onSelectAll,\n  renderSelectionCount,\n  rowHeight,\n  selectable,\n  selectedCount,\n}) {\n  const [opened, setOpened] = useState(-1)\n\n  const toggleEntry = useCallback(index => {\n    setOpened(opened => (opened === index ? -1 : index))\n  }, [])\n\n  const headCells = useMemo(\n    () =>\n      headingsFromFields(fields, {\n        hasAnyActions,\n        hasAnyExpansion,\n        selectContent: (\n          <Checkbox\n            indeterminate={allSelected === 0}\n            checked={allSelected > -1}\n            onChange={onSelectAll}\n          />\n        ),\n        selectable,\n      }),\n    [\n      fields,\n      hasAnyActions,\n      hasAnyExpansion,\n      allSelected,\n      onSelectAll,\n      selectable,\n    ]\n  )\n\n  return (\n    <table\n      css={`\n        width: 100%;\n        border-spacing: 0;\n        border-collapse: separate;\n      `}\n    >\n      {headCells && (\n        <thead>\n          <HeadRow\n            cells={headCells}\n            selectedCount={selectedCount}\n            renderSelectionCount={renderSelectionCount}\n          />\n        </thead>\n      )}\n      <tbody>\n        {entries.map((entry, index) => (\n          <Entry\n            key={entry.index}\n            alignChildOnField={alignChildOnField}\n            entry={entry}\n            fields={fields}\n            firstRow={index === 0}\n            hasAnyActions={hasAnyActions}\n            hasAnyExpansion={hasAnyExpansion}\n            onSelect={onSelect}\n            onToggle={toggleEntry}\n            opened={opened === entry.index}\n            rowHeight={rowHeight}\n            selectable={selectable}\n          />\n        ))}\n      </tbody>\n    </table>\n  )\n}\n\nTableView.propTypes = {\n  alignChildOnField: PropTypes.number.isRequired,\n  allSelected: PropTypes.oneOf([-1, 0, 1]).isRequired,\n  entries: PropTypes.array.isRequired,\n  fields: PropTypes.array.isRequired,\n  hasAnyActions: PropTypes.bool.isRequired,\n  hasAnyExpansion: PropTypes.bool.isRequired,\n  onSelect: PropTypes.func.isRequired,\n  onSelectAll: PropTypes.func.isRequired,\n  renderSelectionCount: PropTypes.func.isRequired,\n  rowHeight: PropTypes.number.isRequired,\n  selectable: PropTypes.bool.isRequired,\n  selectedCount: PropTypes.number.isRequired,\n}\n\n// Disable prop types check for internal components\n/* eslint-disable react/prop-types */\n\nfunction useSidePadding() {\n  const { layoutName } = useLayout()\n  return layoutName === 'small' ? 2 * GU : 3 * GU\n}\n\nfunction HeadRow({ cells, selectedCount, renderSelectionCount }) {\n  const theme = useTheme()\n  const sidePadding = useSidePadding()\n  return (\n    <tr>\n      {cells.map((cell, index) => {\n        const hidden = selectedCount > 0 && index > 1\n        const content =\n          selectedCount > 0 && index === 1\n            ? renderSelectionCount(selectedCount)\n            : cell[0]\n        return (\n          !hidden && (\n            <th\n              key={index}\n              css={`\n                height: ${4 * GU}px;\n                padding: 0;\n                padding-left: ${index === 0 ? sidePadding : 0}px;\n                padding-right: ${index === cells.length - 1\n                  ? sidePadding\n                  : 0}px;\n                text-align: ${cell[1]};\n                ${textStyle('label2')};\n                color: ${theme.surfaceContentSecondary};\n                border-bottom: 1px solid ${theme.border};\n              `}\n              colSpan={selectedCount > 0 && index === 1 ? cells.length - 1 : 1}\n            >\n              {content}\n            </th>\n          )\n        )\n      })}\n    </tr>\n  )\n}\n\nconst Entry = React.memo(function Entry({\n  alignChildOnField,\n  entry,\n  fields,\n  firstRow,\n  hasAnyActions,\n  hasAnyExpansion,\n  onSelect,\n  onToggle,\n  opened,\n  rowHeight,\n  selectable,\n}) {\n  const hasExpansion = entry.expansion.content.length > 0\n  const entryIndex = entry.index\n\n  const handleToggle = useCallback(() => {\n    onToggle(entryIndex)\n  }, [entryIndex, onToggle])\n\n  const handleSelectChange = useCallback(\n    check => {\n      onSelect(entryIndex, check)\n    },\n    [entryIndex, onSelect]\n  )\n\n  const cells = cellsFromEntry(entry, {\n    fields,\n    hasAnyActions,\n    hasAnyExpansion,\n    hasExpansion,\n    selectable,\n    toggleChildContent: hasAnyExpansion ? (\n      <Toggle opened={opened} onToggle={handleToggle} />\n    ) : null,\n    selectContent: selectable ? (\n      <Checkbox onChange={handleSelectChange} checked={entry.selected} />\n    ) : null,\n  })\n\n  return (\n    <React.Fragment>\n      <EntryRow\n        cells={cells}\n        firstRow={firstRow}\n        rowHeight={rowHeight}\n        selected={entry.selected}\n      />\n      {hasExpansion && (\n        <EntryExpansion\n          alignChildOnCell={alignChildOnField + 1}\n          cellsCount={cells.length}\n          expansion={entry.expansion}\n          opened={opened}\n          rowHeight={rowHeight}\n        />\n      )}\n    </React.Fragment>\n  )\n})\n\nfunction EntryRow({ firstRow, cells, selected, rowHeight, mode }) {\n  const theme = useTheme()\n  const sidePadding = useSidePadding()\n\n  return (\n    <tr\n      css={`\n        transition: background 150ms ease-in-out;\n        background: ${selected ? theme.surfaceSelected : 'none'};\n      `}\n    >\n      {cells.map(([content, align, compact], index, cells) => {\n        const first = index === 0\n        const last = index === cells.length - 1\n        return (\n          <td\n            key={index}\n            css={`\n              position: relative;\n              width: ${compact\n                ? '1px' // For some reason Blink tends to make 0 grow but not 1px\n                : 'auto'};\n              height: ${rowHeight}px;\n              padding-top: 0;\n              padding-bottom: 0;\n              padding-left: ${first || compact ? sidePadding : 0}px;\n              padding-right: ${(!first && (align !== 'end' || last)) || compact\n                ? sidePadding\n                : 0}px;\n              border-top: ${firstRow ? '0' : `1px solid ${theme.border}`};\n            `}\n          >\n            <div\n              css={`\n                display: flex;\n                width: 100%;\n                justify-content: ${`flex-${align}`};\n              `}\n            >\n              {content}\n            </div>\n          </td>\n        )\n      })}\n    </tr>\n  )\n}\n\nfunction EntryExpansion({\n  alignChildOnCell,\n  cellsCount,\n  expansion,\n  opened,\n  rowHeight,\n}) {\n  const theme = useTheme()\n\n  // Handles the height of the expansion in free layout mode\n  const [freeLayoutContentHeight, setFreeLayoutContentHeight] = useState(0)\n\n  // We don't want to memoize this callback because we need to query for a new height\n  // and cover updates when entries get re-ordered\n  const handleFreeLayoutContentRef = element => {\n    if (element) {\n      setFreeLayoutContentHeight(element.getBoundingClientRect().height)\n    }\n  }\n\n  const contentHeight = expansion.freeLayout\n    ? freeLayoutContentHeight\n    : rowHeight * expansion.content.length\n\n  return (\n    <Transition\n      native\n      unique\n      items={opened}\n      from={{ height: 0 }}\n      enter={{ height: contentHeight }}\n      update={{ height: contentHeight }}\n      leave={{ height: 0 }}\n      config={{ ...springs.smooth, precision: 0.1 }}\n    >\n      {show =>\n        show &&\n        (({ height }) => (\n          <tr\n            css={`\n              td {\n                position: relative;\n                padding: 0;\n                box-shadow: inset 0 6px 4px -4px rgba(0, 0, 0, 0.16);\n                background: ${theme.surfaceUnder};\n              }\n            `}\n          >\n            {alignChildOnCell > 0 && (\n              <td colSpan={alignChildOnCell}>\n                <OpenedSurfaceBorder opened={opened} />\n                <animated.div\n                  css=\"overflow: hidden\"\n                  style={{\n                    height: height.interpolate(h =>\n                      h !== contentHeight ? `${h}px` : 'auto'\n                    ),\n                  }}\n                >\n                  {expansion.content.map((child, i) => (\n                    <div\n                      key={i}\n                      css={`\n                        height: ${expansion.freeLayout\n                          ? 'auto'\n                          : `${rowHeight}px`};\n                        border-top: 1px solid ${theme.border};\n                      `}\n                    />\n                  ))}\n                </animated.div>\n              </td>\n            )}\n            <td\n              colSpan={\n                alignChildOnCell === -1\n                  ? cellsCount\n                  : cellsCount - alignChildOnCell\n              }\n            >\n              {alignChildOnCell === 0 && (\n                <OpenedSurfaceBorder opened={opened} />\n              )}\n              <animated.div\n                css=\"overflow: hidden\"\n                style={{\n                  height: height.interpolate(h =>\n                    h !== contentHeight ? `${h}px` : 'auto'\n                  ),\n                }}\n              >\n                {expansion.content.map((child, i) => (\n                  <div\n                    key={i}\n                    ref={\n                      expansion.freeLayout ? handleFreeLayoutContentRef : null\n                    }\n                    css={`\n                      display: flex;\n                      align-items: center;\n                      height: ${expansion.freeLayout\n                        ? 'auto'\n                        : `${rowHeight}px`};\n                      padding-left: ${alignChildOnCell < 1 ? 3 * GU : 0}px;\n                      padding-right: ${3 * GU}px;\n                      border-top: 1px solid ${theme.border};\n                    `}\n                  >\n                    {child}\n                  </div>\n                ))}\n              </animated.div>\n            </td>\n          </tr>\n        ))\n      }\n    </Transition>\n  )\n}\n\nconst Toggle = React.memo(function Toggle({ opened, onToggle }) {\n  return (\n    <div\n      css={`\n        width: 100%;\n        height: 100%;\n      `}\n    >\n      <OpenedSurfaceBorder opened={opened} />\n      <ToggleButton opened={opened} onClick={onToggle} />\n    </div>\n  )\n})\n\n/* eslint-enable react/prop-types */\n\nexport { TableView }\n"],"names":["headingsFromFields","fields","hasAnyActions","hasAnyExpansion","selectContent","selectable","cells","map","field","index","label","align","unshift","push","every","cell","cellsFromEntry","entry","hasExpansion","toggleChildContent","entryNodes","content","actions","TableView","alignChildOnField","allSelected","entries","onSelect","onSelectAll","renderSelectionCount","rowHeight","selectedCount","useState","opened","setOpened","toggleEntry","useCallback","headCells","useMemo","Checkbox","propTypes","PropTypes","number","isRequired","oneOf","array","bool","func","useSidePadding","useLayout","layoutName","GU","HeadRow","theme","useTheme","sidePadding","hidden","length","textStyle","surfaceContentSecondary","border","Entry","React","memo","firstRow","onToggle","expansion","entryIndex","handleToggle","handleSelectChange","check","selected","EntryRow","mode","surfaceSelected","compact","first","last","EntryExpansion","alignChildOnCell","cellsCount","freeLayoutContentHeight","setFreeLayoutContentHeight","handleFreeLayoutContentRef","element","getBoundingClientRect","height","contentHeight","freeLayout","springs","smooth","precision","show","surfaceUnder","interpolate","h","child","i","Toggle"],"mappings":"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"}