{"version":3,"file":"TextCopy.js","sources":["../src/components/TextCopy/TextCopy.js"],"sourcesContent":["import React, { useCallback, useImperativeHandle, useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport { IconCopy } from '../../icons/'\nimport { GU, RADIUS, textStyle } from '../../style'\nimport { useTheme } from '../../theme'\nimport { noop, warn } from '../../utils'\nimport TextInput from '../Input/TextInput'\nimport ButtonIcon from '../Button/ButtonIcon'\nimport { useToast } from '../ToastHub/ToastHub'\n\nconst HEIGHT = 5 * GU\n\nconst TextCopy = React.memo(\n  React.forwardRef(function TextCopy(\n    { adornment, autofocus, message, monospace, onCopy, value, ...props },\n    ref\n  ) {\n    const theme = useTheme()\n    const toast = useToast()\n    const inputRef = useRef(null)\n\n    // Allows to focus the component from the outside\n    useImperativeHandle(ref, () => ({\n      focus: () => {\n        inputRef.current.focus()\n      },\n    }))\n\n    // Select the content on focus\n    const handleFocus = useCallback(() => {\n      inputRef.current && inputRef.current.select()\n    }, [])\n\n    // If onCopy is set (either to a function or null), Toast is not used.\n    const onCopyOrToast = onCopy === undefined ? toast : onCopy || noop\n\n    const handleCopy = useCallback(() => {\n      if (inputRef.current) {\n        inputRef.current.focus()\n\n        try {\n          document.execCommand('copy')\n          onCopyOrToast(message)\n        } catch (err) {\n          warn(err)\n        }\n      }\n    }, [message, onCopyOrToast])\n\n    return (\n      <div\n        css={`\n          position: relative;\n          display: inline-flex;\n          width: ${52.5 * GU}px;\n          max-width: 100%;\n          height: ${HEIGHT}px;\n          padding-left: ${adornment ? `${HEIGHT}px` : '0'};\n        `}\n        {...props}\n      >\n        {adornment && (\n          <div\n            css={`\n              position: absolute;\n              top: 0;\n              left: 0;\n              overflow: hidden;\n              width: ${HEIGHT}px;\n              height: ${HEIGHT}px;\n              background: ${theme.surface};\n              border: 1px solid ${theme.border};\n              border-right: 0;\n\n              // 0.0001px fixes an issue on Blink browsers, where each\n              // border-radius need to be non 0 for overflow:hidden to work.\n              border-radius: ${RADIUS}px 0.0001px 0.0001px ${RADIUS}px;\n            `}\n          >\n            <div\n              css={`\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                width: ${HEIGHT - 2}px;\n                height: ${HEIGHT - 2}px;\n              `}\n            >\n              {adornment}\n            </div>\n          </div>\n        )}\n        <TextInput\n          ref={inputRef}\n          adornment={\n            <ButtonIcon\n              onClick={handleCopy}\n              label=\"Copy\"\n              css={`\n                width: ${HEIGHT - 2}px;\n                height: ${HEIGHT - 2}px;\n                border-radius: 0;\n                color: ${theme.surfaceIcon};\n              `}\n            >\n              <IconCopy />\n            </ButtonIcon>\n          }\n          adornmentPosition=\"end\"\n          adornmentSettings={{\n            // Keep the button square\n            width: HEIGHT - 2,\n            padding: 0,\n          }}\n          autofocus={autofocus}\n          onFocus={handleFocus}\n          readOnly\n          value={value}\n          wide\n          css={`\n            text-overflow: ellipsis;\n            height: ${HEIGHT}px;\n            max-width: 100%;\n            border: 1px solid ${theme.border};\n            ${adornment\n              ? `\n                  border-top-left-radius: 0;\n                  border-bottom-left-radius: 0;\n                  border-left: 0;\n                `\n              : ''};\n            ${textStyle(monospace ? 'address2' : 'body3')};\n            &:read-only {\n              color: ${theme.surfaceContent};\n              text-shadow: none;\n            }\n          `}\n        />\n      </div>\n    )\n  })\n)\n\nTextCopy.propTypes = {\n  adornment: PropTypes.node,\n  autofocus: PropTypes.bool,\n  message: PropTypes.string,\n  monospace: PropTypes.bool,\n  onCopy: PropTypes.func,\n  value: PropTypes.string,\n}\n\nTextCopy.defaultProps = {\n  autofocus: false,\n  message: 'Copied',\n  monospace: true,\n}\n\nexport default TextCopy\n"],"names":["HEIGHT","GU","RADIUS","TextCopy","React","memo","forwardRef","ref","adornment","autofocus","message","monospace","onCopy","value","props","theme","useTheme","toast","useToast","inputRef","useRef","useImperativeHandle","focus","current","handleFocus","useCallback","select","onCopyOrToast","undefined","noop","handleCopy","document","execCommand","err","warn","surface","border","surfaceIcon","IconCopy","width","padding","textStyle","surfaceContent","propTypes","PropTypes","node","bool","string","func","defaultProps"],"mappings":"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"}